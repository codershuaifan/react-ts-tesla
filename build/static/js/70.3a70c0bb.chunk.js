"use strict";(self.webpackChunkreact_ts_tesla=self.webpackChunkreact_ts_tesla||[]).push([[70],{7070:function(n,e,t){t.d(e,{_F:function(){return v},mS:function(){return I},bT:function(){return O},D5:function(){return x},jf:function(){return R},$2:function(){return T}});var o=t(4165),r=t(5671),a=t(3144),i=t(136),u=t(7277),c=t(5861),s=t(2791),l={};function f(n,e){void 0===e&&(e="_react_amap_plugin");var t=document&&(document.head||document.getElementsByTagName("head")[0]),o=document.getElementById(e);return new Promise((function(r,a){if(!document||n in l||o)r();else{var i=document.createElement("script");i.type="text/javascript",i.id=e,i.async=!0,i.defer=!0,i.src=n,i.onerror=function(e){t.removeChild(i),a(new URIError("The Script "+n+" is no accessible."))},i.onload=function(){l[n]=!0,r()},t.appendChild(i)}}))}var p=t(184);function d(n){return new Promise((function(e,t){window.setTimeout(e,n)}))}var v=function(n){(0,i.Z)(t,n);var e=(0,u.Z)(t);function t(n){var o;if((0,r.Z)(this,t),(o=e.call(this,n)).isMountedOk=!1,o.state={loaded:!!window.AMap},o.handleError=function(n){o.isMountedOk&&o.setState({error:n})},o.finish=function(){o.isMountedOk&&o.setState({loaded:!0})},null===n.akay)throw new TypeError("AMap: akay is required");return o}return(0,a.Z)(t,[{key:"componentDidMount",value:function(){this.isMountedOk=!0;var n=this.props.callbackName;if(null==window.AMap){if(window[n])return void t.waitQueue.push([this.finish,this.handleError]);this.loadMap()}}},{key:"componentWillUnmount",value:function(){this.isMountedOk=!1}},{key:"render",value:function(){return this.state.loaded?this.props.children:this.props.fallback?this.props.fallback(this.state.error):this.state.error?(0,p.jsx)("div",{style:{color:"red"},children:this.state.error.message}):null}},{key:"getScriptSrc",value:function(){var n=this.props,e=n.protocol||window.location.protocol;-1===e.indexOf(":")&&(e+=":");var t="";return n.plugin&&(t="&plugin="+n.plugin),e+"//"+n.hostAndPath+"?v="+n.version+"&key="+n.akay+"&callback="+n.callbackName+t}},{key:"loadMap",value:function(){var n=this;return(0,c.Z)((0,o.Z)().mark((function e(){var r,a,i,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.props.callbackName,a=n.getScriptSrc(),window[r]=function(){var e=t.waitQueue;t.waitQueue=[],e.forEach((function(n){return n[0]()})),n.finish()},i=0;case 4:if(!(i<3)){e.next=22;break}return e.prev=5,e.next=8,f(a);case 8:return e.abrupt("break",22);case 11:if(e.prev=11,e.t0=e.catch(5),2!==i){e.next=17;break}if("object"!==typeof(u=function(){var o=new Error("Failed to load AMap: "+e.t0.message),r=t.waitQueue;return t.waitQueue=[],r.forEach((function(n){return n[1](o)})),n.handleError(o),{v:void 0}}())){e.next=17;break}return e.abrupt("return",u.v);case 17:return e.next=19,d(1e3*i);case 19:i++,e.next=4;break;case 22:case"end":return e.stop()}}),e,null,[[5,11]])})))()}}]),t}(s.Component);v.defaultProps={protocol:/^file:/.test(window.location.protocol)?"https":window.location.protocol,akay:"",hostAndPath:"webapi.amap.com/maps",version:"2.0",callbackName:"load_amap_sdk",plugin:""},v.waitQueue=[];var m=t(4942),h=t(885),M=t(7462);t(4164);function w(n,e){var t=(0,s.useState)(e),o=(0,h.Z)(t,2),r=o[0],a=o[1];(0,s.useEffect)((function(){n&&void 0!==e&&(e?n.show&&n.show():n.hide&&n.hide(),e!==r&&a(e))}),[n,e])}function C(n,e,t,o){void 0===e&&(e={}),void 0===t&&(t=[]),t.forEach((function(t){var o=t,r=e[o];(0,s.useEffect)((function(){if(n){var e=t.toLocaleLowerCase().replace(/^on/,"");return r&&e&&n.on(e,r),function(){e&&r&&n.off(e,r)}}}),[n,e[o]])}))}function k(n,e){if(null==n)return{};var t,o,r={},a=Object.keys(n);for(o=0;o<a.length;o++)t=a[o],e.indexOf(t)>=0||(r[t]=n[t]);return r}var E={map:void 0,AMap:void 0,container:void 0},y=function(n,e){return(0,M.Z)({},n,e)},Z=s.createContext({state:E,dispatch:function(){return null}});function A(){var n=(0,s.useContext)(Z),e=n.state,t=n.dispatch;return(0,M.Z)({},e,{state:e,dispatch:t})}var g=function(n){void 0===n&&(n={});var e=(0,M.Z)({},n),t=(0,s.useState)(),o=(0,h.Z)(t,2),r=o[0],a=o[1],i=(0,s.useState)(n.zoom||15),u=(0,h.Z)(i,2),c=u[0],l=u[1],f=(0,s.useState)(n.container),p=(0,h.Z)(f,2),d=p[0],v=p[1],w=(0,s.useContext)(Z).dispatch;return(0,s.useEffect)((function(){if(d&&!r&&AMap){d.className=d.className+" react-amap-wapper";var n=new AMap.Map(d,(0,M.Z)({zoom:c},e));a(n)}return function(){r&&(r.clearInfoWindow(),r.clearLimitBounds(),r.clearMap(),r.destroy(),a(void 0))}}),[d,r]),(0,s.useEffect)((function(){return r&&d&&w({map:r,container:d,AMap:AMap}),function(){w({map:void 0,container:void 0,AMap:void 0})}}),[r,d]),(0,s.useMemo)((function(){r&&"number"===typeof n.zoom&&c!==n.zoom&&n.zoom>=2&&n.zoom<=20&&(l(n.zoom),r.setZoom(n.zoom))}),[c,n.zoom]),(0,s.useMemo)((function(){n.center&&r&&r.setCenter(n.center)}),[r,n.center]),function(n,e,t){void 0===e&&(e={}),void 0===t&&(t=[]),t.forEach((function(t){var o=t,r=(0,s.useState)(e[o]),a=(0,h.Z)(r,2),i=a[0],u=a[1];(0,s.useEffect)((function(){if(n&&void 0!==e[o]&&e[o]!==i){var t=n.getStatus();n.setStatus((0,M.Z)({},t,(0,m.Z)({},o,e[o]))),u(e[o])}}),[n,e[o]])}))}(r,n,["dragEnable","zoomEnable","jogEnable","pitchEnable","rotateEnable","animateEnable","keyboardEnable"]),function(n,e,t){void 0===n&&(n={}),void 0===e&&(e={}),void 0===t&&(t=[]),t.forEach((function(t){var o="set"+t,r=""+t.charAt(0).toLowerCase()+t.slice(1),a=(0,s.useState)(e[r]),i=(0,h.Z)(a,2),u=i[0],c=i[1];(0,s.useEffect)((function(){n&&void 0!==e[r]&&e[r]!==u&&n[o]&&"function"===typeof n[o]&&(n[o](e[r]),c(e[r]))}),[n,e[r]])}))}(r,n,["Zoom","LabelzIndex","Layers","City","Bounds","LimitBounds","Lang","Rotation","DefaultCursor","MapStyle","Features","DefaultLayer","Pitch"]),C(r,n,["onMouseMove","onZoomChange","onMapMove","onMouseWheel","onZoomStart","onMouseOver","onMouseOut","onDblClick","onClick","onZoomEnd","onMoveEnd","onMouseUp","onMouseDown","onRightClick","onMoveStart","onDragStart","onDragging","onDragEnd","onHotspotOut","onHotspotOver","onTouchStart","onComplete","onHotspotClick","onTouchMove","onTouchEnd","onResize"]),{map:r,setMap:a,zoom:c,setZoom:l,container:d,setContainer:v}},b=["className","children"];var x=(0,s.forwardRef)((function(n,e){var t=n.className,o=n.children,r=k(n,b),a=(0,s.useReducer)(y,E),i=(0,h.Z)(a,2),u=i[0],c=i[1],l=(0,s.useRef)(null),f=g((0,M.Z)({container:r.container||l.current},r)),d=f.setContainer,v=f.container,m=f.map;(0,s.useEffect)((function(){return d(l.current)}),[l.current]),(0,s.useImperativeHandle)(e,(function(){return(0,M.Z)({},r,{map:m,AMap:AMap,container:r.container||l.current})}),[m]);var w=s.Children.toArray(o);return(0,s.useEffect)((function(){m&&c({map:m,container:l.current,AMap:AMap})}),[m]),(0,p.jsxs)(Z.Provider,{value:(0,M.Z)({},u,{state:u,dispatch:c}),children:[!r.container&&(0,p.jsx)("div",{ref:l,className:"react-amap-wapper "+t,style:(0,M.Z)({fontSize:1,width:"100%",height:"100%"},r.style)}),AMap&&m&&"function"===typeof o&&o({AMap:AMap,map:m,container:v}),AMap&&m&&w.map((function(n,e){return(0,s.isValidElement)(n)?"string"===typeof n?(0,s.cloneElement)((0,p.jsx)(s.Fragment,{children:n}),{key:e}):n.type&&"string"===typeof n.type?(0,s.cloneElement)(n,{key:e}):(0,s.cloneElement)(n,(0,M.Z)({},n.props,{AMap:AMap,map:m,container:v,key:e})):null}))]})})),S=["position"],B=function(){};s.forwardRef((function(n,e){var t=function(n){void 0===n&&(n={});var e=n.position,t=k(n,S),o=A().map,r=(0,s.useState)(),a=(0,h.Z)(r,2),i=a[0],u=a[1];return(0,s.useEffect)((function(){if(AMap&&o&&!i){var n=new AMap.ContextMenu((0,M.Z)({},t));u(n);var r=function(t){return n.open(o,e||t.lnglat)};return o.on("rightclick",r),function(){n&&(o.off("rightclick",r),o&&o.removeLayer(n),u(void 0))}}}),[o]),C(i,n,["onOpen","onClose"]),{contextMenu:i,setContextMenu:u}}(n),o=t.contextMenu;(0,s.useImperativeHandle)(e,(function(){return(0,M.Z)({},n,{contextMenu:o})}));var r=s.Children.toArray(n.children);return(0,p.jsx)(s.Fragment,{children:AMap&&o&&r.map((function(e,t){return s.isValidElement(e)?s.cloneElement(e,(0,M.Z)({},e.props,{AMap:AMap,map:n.map,contextMenu:o,key:t})):null}))})})).Item=function(n){void 0===n&&(n={});var e=n,t=e.text,o=void 0===t?"":t,r=e.onClick,a=void 0===r?B:r;return(0,s.useEffect)((function(){return n.contextMenu&&n.contextMenu.addItem(o,a,1),function(){n.contextMenu&&n.contextMenu.removeItem(o,a)}}),[n.contextMenu,n.text,n.onClick]),null};var I=s.forwardRef((function(n,e){var t=function(n){void 0===n&&(n={});var e=n,t=e.position,o=e.visiable,r=e.offset,a=(0,s.useState)(),i=(0,h.Z)(a,2),u=i[0],c=i[1],l=A().map;return(0,s.useEffect)((function(){var n;if(l&&!u)return l.plugin(["AMap.ControlBar","AMap.HawkEye"],(function(){n=new AMap.ControlBar({offset:r,position:t}),l.addControl(n),c(n)})),function(){n&&l.removeControl(n)}}),[l]),w(u,o),{controlBarControl:u,setControlBarControl:c}}(n),o=t.controlBarControl;return(0,s.useImperativeHandle)(e,(function(){return(0,M.Z)({},n,{controlBarControl:o})}),[o]),null})),z=["type","onComplete","onError"],O=s.forwardRef((function(n,e){var t=function(n){void 0===n&&(n={});var e=n,t=e.type,o=void 0===t?"position":t,r=e.onComplete,a=e.onError,i=k(n,z),u=(0,s.useState)(),c=(0,h.Z)(u,2),l=c[0],f=c[1],p=A().map;function d(n,e){"complete"===n&&r?r(e):a&&a(e)}return(0,s.useEffect)((function(){var n;if(AMap&&!l)return AMap.plugin(["AMap.Geolocation"],(function(){n=new AMap.Geolocation((0,M.Z)({},i)),f(n)})),function(){n&&f(void 0)}}),[AMap]),(0,s.useMemo)((function(){if(/^(position|cityInfo)$/.test(o)){var n="position"===o?"getCurrentPosition":"getCityInfo";l&&p?(l[n](d),p.addControl(l)):l&&l[n](d)}}),[l]),{geolocation:l,setGeolocation:f}}(n),o=t.geolocation;return(0,s.useImperativeHandle)(e,(function(){return(0,M.Z)({},n,{geolocation:o})})),null}));var R=s.forwardRef((function(n,e){var t=function(n){void 0===n&&(n={});var e=(0,s.useState)(),t=(0,h.Z)(e,2),o=t[0],r=t[1],a=n,i=a.position,u=a.visiable,c=a.offset,l=A().map;return(0,s.useEffect)((function(){var n;if(l&&!o)return l.plugin(["AMap.Scale"],(function(){n=new AMap.Scale({offset:c,position:i}),l.addControl(n),r(n)})),function(){n&&l.removeControl(n)}}),[l]),w(o,u),{scaleControl:o,setScaleControl:r}}(n),o=t.scaleControl;return(0,s.useImperativeHandle)(e,(function(){return(0,M.Z)({},n,{scaleControl:o})}),[o]),null}));var T=s.forwardRef((function(n,e){var t=function(n){void 0===n&&(n={});var e=(0,s.useState)(),t=(0,h.Z)(e,2),o=t[0],r=t[1],a=n,i=a.position,u=a.visiable,c=a.offset,l=A().map;return(0,s.useEffect)((function(){var n;if(l&&!o)return l.plugin(["AMap.ToolBar"],(function(){n=new AMap.ToolBar({offset:c,position:i}),l.addControl(n),r(n)})),function(){n&&l.removeControl(n)}}),[l]),w(o,u),{toolBarControl:o,setToolBarControl:r}}(n),o=t.toolBarControl;return(0,s.useImperativeHandle)(e,(function(){return(0,M.Z)({},n,{toolBarControl:o})}),[o]),null}))}}]);
//# sourceMappingURL=70.3a70c0bb.chunk.js.map